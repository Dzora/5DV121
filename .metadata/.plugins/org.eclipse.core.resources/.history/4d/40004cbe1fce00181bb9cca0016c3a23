package lab5;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

public class Parser {

	private Images images;
	private int matrixIndex = 0;
	private String heading = "";

	public Parser() {
		this.images = new Images();
	}

	public void readFile(String fileName) throws FileNotFoundException,
			IOException {
		try (BufferedReader br = new BufferedReader(new FileReader(fileName))) {
			String line;
			while ((line = br.readLine()) != null) {
				checkForNewImage(line);

			}
		}
	}

	private void checkForNewImage(String line) {
		if (!line.contains("#")) {
			if (line.contains("Image")) {
				String heading = line;
				System.out.println("Heading : " + heading);
			} else {
				System.out.println("MatrixIndex : " + matrixIndex);
				if(matrixIndex == 20) {
					matrixIndex = 0;
				}
				readAllGreyLevels(line);
				matrixIndex++;
			}
		}
	}

	private void readAllGreyLevels(String line) {
		int[][] image = new int[20][20];
		int j = 0;
		for (int i = 0; i < line.length(); i++) {
			if (Character.isDigit(line.charAt(i))) {
				System.out.println(j);
				image[matrixIndex][j] = line.charAt(i);
				j++;
			}
		}
		images.imageBlockMap.put(heading, image);
	}

}
